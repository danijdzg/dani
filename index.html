<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
    <title>DaniCtas</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<meta name="theme-color" content="#00B34D" />
	<link rel="manifest" href="manifest.json">	
	<link rel="icon" href="favicon.ico" sizes="any">
    <link rel="icon" href="icons/favicon-32x32.png" type="image/png" sizes="32x32">
    <link rel="icon" href="icons/favicon-16x16.png" type="image/png" sizes="16x16">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
	<meta name="theme-color" content="#00B34D" />
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-treemap@2.3.0"></script>
	<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>   
    <link rel="stylesheet" href="style.css">	
</head>

<body data-ledger-mode="A">
    <noscript>You need to enable JavaScript to run this app.</noscript>
     
    <div id="login-screen" class="login-view">
        <div class="starry-background"></div>
        <div class="login-view__card">
            <div class="login-view__logo" style="display: flex; align-items: center; justify-content: center; width: 90px; height: 90px; background: var(--c-surface-variant); border-radius: 24px; margin: 0 auto 1rem auto; box-shadow: 0 0 25px rgba(0, 179, 77, 0.2);">
				<span class="material-icons" style="font-size: 48px; color: var(--c-primary);">lock</span>
			</div>
            <h2 id="login-title" class="login-view__title">Bienvenido de nuevo</h2>
            <p class="login-view__tagline">Inicia sesi√≥n para controlar tus finanzas.</p>
            <form id="login-form" noValidate>
                <div class="form-group form-group--with-icon">
                    <span class="material-icons">alternate_email</span>
                    <input type="email" id="login-email" class="form-input" placeholder="Correo electr√≥nico" required autoComplete="email" autoCapitalize="none" aria-describedby="login-email-error" />
                    <span class="form-error" id="login-email-error"></span>
                </div>
                <div class="form-group form-group--with-icon">
                    <span class="material-icons">lock</span>
                    <input type="password" id="login-password" class="form-input" placeholder="Contrase√±a" required autoComplete="current-password" aria-describedby="login-password-error" />
                    <span class="form-error" id="login-password-error"></span>
                </div>
                <div class="login-view__actions">
                    <a href="#" class="login-view__link" data-action="forgot-password">¬øOlvidaste tu contrase√±a?</a>
                </div>
                <p id="login-error" class="form-error" style="min-height: 16px; margin-top: 8px;"></p>
                <div class="login-view__footer">
                    <button type="submit" data-action="login" class="btn btn--primary btn--full">Iniciar Sesi√≥n</button>
                    <p class="login-view__secondary-action">
                        <span>¬øNo tienes una cuenta?</span> <a href="#" class="login-view__link" data-action="show-register">Reg√≠strate aqu√≠</a>
                    </p>
                </div>
            </form>
        </div>
    </div>

    <div id="pin-login-screen" class="login-view">
        <div class="starry-background"></div>
        <div class="login-view__card">
            <div class="login-view__logo" style="display: flex; align-items: center; justify-content: center; width: 90px; height: 90px; background: var(--c-surface-variant); border-radius: 24px; margin: 0 auto 1rem auto; box-shadow: 0 0 25px rgba(0, 179, 77, 0.2);">
    <span class="material-icons" style="font-size: 48px; color: var(--c-primary);">lock</span>
</div>
            <h2 class="login-view__title">Acceso R√°pido</h2>
            <p class="login-view__tagline">Introduce tu PIN de 4 d√≠gitos.</p>
            <form id="pin-form">
                <div class="pin-inputs" id="pin-inputs-container">
                    <input type="password" class="pin-input" pattern="[0-9]*" inputmode="numeric" maxlength="1" required>
                    <input type="password" class="pin-input" pattern="[0-9]*" inputmode="numeric" maxlength="1" required>
                    <input type="password" class="pin-input" pattern="[0-9]*" inputmode="numeric" maxlength="1" required>
                    <input type="password" class="pin-input" pattern="[0-9]*" inputmode="numeric" maxlength="1" required>
                </div>
                <p id="pin-error" class="form-error" style="min-height: 16px; margin-top: 8px;"></p>
            </form>
            <div class="login-view__footer">
                <p class="login-view__secondary-action">
                    <a href="#" class="login-view__link" data-action="use-password-instead">Usar contrase√±a en su lugar</a>
                </p>
                <p class="login-view__secondary-action" style="margin-top: var(--sp-2);">
                    <a href="#" class="login-view__link" data-action="logout">O iniciar sesi√≥n con otra cuenta</a>
                </p>
            </div>
        </div>
    </div>
    
    <div id="app-root" class="app-layout">
        <!-- ‚ñº‚ñº‚ñº INICIO: NUEVA BARRA DE NAVEGACI√ìN PRINCIPAL ‚ñº‚ñº‚ñº -->
        <nav class="bottom-nav">
            <button data-action="navigate" data-page="panel-page" class="bottom-nav__item">
                <span class="material-icons">dashboard</span>
                <span class="bottom-nav__label">Panel</span>
            </button>
            <button data-action="navigate" data-page="diario-page" class="bottom-nav__item">
                <span class="material-icons">receipt_long</span>
                <span class="bottom-nav__label">Diario</span>
            </button>
            
            <!-- ‚ñº‚ñº‚ñº BOT√ìN MODIFICADO PARA GESTI√ìN INTELIGENTE ‚ñº‚ñº‚ñº -->
            <!-- Le hemos quitado el 'data-action' para controlarlo manualmente en JS -->
            <button id="bottom-nav-add-btn">
                <span class="material-icons">add</span>
            </button>
            <!-- ‚ñ≤‚ñ≤‚ñ≤ FIN BOT√ìN MODIFICADO ‚ñ≤‚ñ≤‚ñ≤ -->
            
            <button data-action="navigate" data-page="patrimonio-page" class="bottom-nav__item">
                <span class="material-icons">account_balance</span>
                <span class="bottom-nav__label">Patrimonio</span>
            </button>
            <button data-action="navigate" data-page="planificar-page" class="bottom-nav__item">
                <span class="material-icons">edit_calendar</span>
                <span class="bottom-nav__label">Planificar</span>
            </button>
        </nav>
        <!-- ‚ñ≤‚ñ≤‚ñ≤ FIN: NUEVA BARRA DE NAVEGACI√ìN PRINCIPAL ‚ñ≤‚ñ≤‚ñ≤ -->

        <header id="app-top-bar" class="top-bar">
            <div class="top-bar__left-group">
                <div id="top-bar-left-button" class="top-bar__left-button"></div>
            </div>
            <h1 id="top-bar-title" class="top-bar__title"></h1>
            <div id="top-bar-actions" class="top-bar__actions"></div>
			<span id="sync-status-icon" class="material-icons"></span>
        </header>

        <main class="app-layout__main">
            <section id="panel-page" class="view"></section>
            <section id="diario-page" class="view" style="padding: 0; gap: 0;"></section>
            <section id="patrimonio-page" class="view"></section>
            <section id="planificar-page" class="view"></section>
            <section id="ajustes-page" class="view"></section>
        </main>
    </div>
    
    <div id="toast-container" aria-live="assertive"></div>
    
 <!-- EN index.html - REEMPLAZA EL MODAL #movimiento-modal POR COMPLETO -->
<div id="movimiento-modal" class="modal-overlay" role="dialog" aria-modal="true">
    <div class="modal">
        <div class="modal__grabber"></div>
        
        <header class="modal__header">
            <h3 id="form-movimiento-title" class="modal__title">Nuevo Movimiento</h3>
            <button class="icon-btn" data-action="close-modal" data-modal-id="movimiento-modal"><span class="material-icons">close</span></button>
        </header>
        
        <div class="modal__body">
            <form id="form-movimiento" novalidate>
                <input type="hidden" id="movimiento-id" />
                <input type="hidden" id="movimiento-mode" value="new" />

                <div class="filter-pills" style="justify-content: center;">
                    <button type="button" class="filter-pill filter-pill--active" data-action="set-movimiento-type" data-type="gasto">Gasto</button>
                    <button type="button" class="filter-pill" data-action="set-movimiento-type" data-type="ingreso">Ingreso</button>
                    <button type="button" class="filter-pill" data-action="set-movimiento-type" data-type="traspaso">Traspaso</button>
                </div>

                <div class="form-field-compact" id="movimiento-cantidad-form-group">
                    <label for="movimiento-cantidad">IMPORTE (‚Ç¨)</label>
                    <div class="input-wrapper">
                         <input type="text" id="movimiento-cantidad" required placeholder="0,00" inputmode="decimal" autocomplete="off" class="input-amount-calculator" />
                    </div>
                    <span class="form-error" id="movimiento-cantidad-error"></span>
                </div>

                <div class="dense-form-grid">
                    
                    <div id="movimiento-fields">
                        <div class="form-field-compact">
                            
                            <div class="input-wrapper">
                                <select id="movimiento-concepto" required></select>
                            </div>
                        </div>
                        <div class="form-field-compact">
                            
                            <div class="input-wrapper">
                                <select id="movimiento-cuenta" required></select>
                            </div>
                        </div>
                        <div class="form-field-compact">
                            <label for="movimiento-descripcion">DETALLE</label>
                            <div class="input-wrapper">
                                <input type="text" id="movimiento-descripcion" required placeholder="Nota..." autocomplete="off" />
                            </div>
                            </div>
                    </div>

                    <div id="traspaso-fields" class="hidden">
                        <div class="form-field-compact">
                            
                            <div class="input-wrapper">
                                <select id="movimiento-cuenta-origen"></select>
                            </div>
                        </div>
                        <div class="form-field-compact">
                            
                            <div class="input-wrapper">
                                <select id="movimiento-cuenta-destino"></select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="date-recurrent-row">
                    <div class="input-wrapper" style="flex: 1;">
                        <input type="date" id="movimiento-fecha" class="visually-hidden" required />
                        <button type="button" id="movimiento-fecha-display" class="date-button-compact">
                            <span class="material-icons" style="font-size: 16px;">calendar_today</span>
                            <span id="movimiento-fecha-text">Hoy</span>
                        </button>
                    </div>
                    
                    <div class="recurrent-toggle-compact">
                        <label for="movimiento-recurrente">Repetir</label>
                        <label class="form-switch">
                            <input type="checkbox" id="movimiento-recurrente">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div id="recurrent-options" class="hidden" style="margin-bottom: 4px;">
    <div class="recurrent-options__main" style="display: flex; gap: 6px;">
        <select id="recurrent-frequency" style="flex: 1.2; min-width: 0;">
            <option value="monthly" selected>Mensual</option>
            <option value="weekly">Semanal</option>
            <option value="daily">Diaria</option>
            <option value="yearly">Anual</option>
        </select>
        
        <input type="date" id="recurrent-next-date" title="Inicio" style="flex: 1; min-width: 0;">
        
        <input type="date" id="recurrent-end-date" title="Fin (Opcional)" style="flex: 1; min-width: 0; color: var(--c-on-surface-secondary);">
    </div>
    
    <div id="weekly-day-selector" class="hidden" style="margin-top:6px;">
        <div id="weekly-day-selector-buttons">
            <button type="button" class="day-selector-btn" data-day="1">L</button>
            <button type="button" class="day-selector-btn" data-day="2">M</button>
            <button type="button" class="day-selector-btn" data-day="3">X</button>
            <button type="button" class="day-selector-btn" data-day="4">J</button>
            <button type="button" class="day-selector-btn" data-day="5">V</button>
            <button type="button" class="day-selector-btn" data-day="6">S</button>
            <button type="button" class="day-selector-btn" data-day="0">D</button>
        </div>
    </div>
</div>

                <div class="modal__actions">
     <button type="button" id="delete-movimiento-btn" data-action="delete-movement-from-modal" class="icon-btn hidden" style="background: var(--c-surface-variant); width: 40px;" title="Eliminar"><span class="material-icons text-danger">delete</span></button>
     
     <button type="button" id="duplicate-movimiento-btn" data-action="duplicate-movement-from-modal" class="icon-btn hidden" style="background: var(--c-surface-variant); width: 40px;" title="Duplicar"><span class="material-icons text-warning">content_copy</span></button>
     
     <button id="save-and-new-movimiento-btn" type="button" data-action="save-and-new-movement" class="btn btn--secondary" style="flex: 1;">+ Otro</button>
     <button id="save-movimiento-btn" type="submit" class="btn btn--primary" style="flex: 1.5;">Guardar</button>
</div>
            </form>
        </div>
    </div>
</div>
                 
    <div id="generic-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="generic-modal-title">
        <div class="modal">
            <header class="modal__header">
                <h3 id="generic-modal-title" class="modal__title"></h3>
                <button class="icon-btn" data-action="close-modal" data-modal-id="generic-modal" title="Cerrar" aria-label="Cerrar"><span class="material-icons">close</span></button>
            </header>
            <div id="generic-modal-body" class="modal__body"></div>
        </div>
    </div>

	<div id="diario-filters-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="diario-filters-title">
        <div class="modal">
            <div class="modal__grabber"></div>
            <header class="modal__header" style="padding-top: var(--sp-2);">
                <h3 id="diario-filters-title" class="modal__title">Filtrar Diario</h3>
                <button class="icon-btn" data-action="close-modal" data-modal-id="diario-filters-modal" title="Cerrar" aria-label="Cerrar"><span class="material-icons">close</span></button>
            </header>
            <div class="modal__body">
                <form id="diario-filters-form" novalidate>
                    <div class="form-group"><label class="form-label">Rango de Fechas</label><div class="form-grid" style="grid-template-columns: 1fr 1fr;"><input type="date" id="filter-diario-start-date" class="form-input"><input type="date" id="filter-diario-end-date" class="form-input"></div></div>
                    <div class="form-group"><label for="filter-diario-description" class="form-label">La descripci√≥n contiene...</label><input type="search" id="filter-diario-description" class="form-input" placeholder="Ej: Amazon, compra semanal..."></div>
                    <div class="form-group"><label class="form-label">Importe entre...</label><div class="form-grid" style="grid-template-columns: 1fr 1fr;"><input type="number" id="filter-diario-min-amount" class="form-input" placeholder="M√≠nimo (‚Ç¨)"><input type="number" id="filter-diario-max-amount" class="form-input" placeholder="M√°ximo (‚Ç¨)"></div></div>
                    <div class="form-group"><label for="filter-diario-cuentas" class="form-label">Cuentas (selecci√≥n m√∫ltiple)</label><select id="filter-diario-cuentas" class="form-select" multiple style="height: 120px;"></select></div>
                    <div class="form-group"><label for="filter-diario-conceptos" class="form-label">Conceptos (selecci√≥n m√∫ltiple)</label><select id="filter-diario-conceptos" class="form-select" multiple style="height: 120px;"></select></div>
                    <div class="modal__actions" style="justify-content: space-between;"><button type="button" data-action="clear-diario-filters" class="btn btn--secondary">Limpiar Filtros</button><button type="submit" class="btn btn--primary">Aplicar Filtros</button></div>
                </form>
            </div>
        </div>
    </div>

    <div id="global-search-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="global-search-title">
        <div class="modal"><header class="modal__header"><div id="global-search-input-wrapper"><span class="material-icons" style="color: var(--c-on-surface-secondary);">search</span><input type="search" id="global-search-input" placeholder="Buscar en toda la app..." autocomplete="off"></div><button class="icon-btn" data-action="close-modal" data-modal-id="global-search-modal" title="Cerrar" aria-label="Cerrar"><span class="material-icons">close</span></button></header><div id="global-search-results" class="modal__body"><div class="empty-state" style="background:transparent; border: none;"><span class="material-icons">manage_search</span><h3>Encu√©ntralo todo</h3><p>Busca movimientos, cuentas o conceptos. <br>Atajo: <strong>Cmd/Ctrl + K</strong></p></div></div></div>
    </div>
    
    <div id="json-import-wizard-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="json-wizard-title">
        <div class="modal" style="max-width: 500px; height: auto; max-height: 85vh;"><header class="modal__header"><h3 id="json-wizard-title" class="modal__title">Asistente de Importaci√≥n JSON</h3><button class="icon-btn" data-action="close-modal" data-modal-id="json-import-wizard-modal" title="Cerrar" aria-label="Cerrar"><span class="material-icons">close</span></button></header><div id="json-wizard-body" class="modal__body" style="display: flex; flex-direction: column;"><div id="json-wizard-step-1" class="json-wizard-step"><h4>Paso 1: Selecciona tu copia de seguridad</h4><p class="form-label" style="margin-bottom: var(--sp-3);">Arrastra y suelta el archivo <code>.json</code> o haz clic para seleccionarlo. La importaci√≥n reemplazar√° <strong>todos</strong> tus datos actuales.</p><div id="json-drop-zone"><span class="material-icons" style="font-size: 48px; color: var(--c-outline);">upload_file</span><p id="json-drop-zone-text">Arrastra tu archivo aqu√≠ o haz clic</p></div><div id="json-file-error" class="form-error" style="text-align: center; margin-top: var(--sp-3);"></div></div><div id="json-wizard-step-2" class="json-wizard-step" style="display: none;"><h4>Paso 2: Revisa y confirma</h4><p class="form-label" style="margin-bottom: var(--sp-3);">Hemos analizado tu archivo. Si los datos son correctos, pulsa "Importar" para reemplazar tus datos actuales.</p><div id="json-preview-container"><ul id="json-preview-list"></ul><div class="form-error" style="margin-top: var(--sp-2); text-align: center;"><strong>Atenci√≥n:</strong> <span>Esta acci√≥n es irreversible.</span></div></div><div class="modal__actions" style="justify-content: space-between;"><button class="btn btn--secondary" data-action="json-wizard-back-2">Atr√°s</button><button class="btn btn--danger" data-action="json-wizard-import-final"><span class="material-icons">warning</span><span>Importar y Reemplazar</span></button></div></div><div id="json-wizard-step-3" class="json-wizard-step" style="display: none; justify-content: center; align-items: center; text-align: center; min-height: 200px;"><div id="json-import-progress"><span class="spinner" style="width: 48px; height: 48px; border-width: 4px;"></span><h4 style="margin-top: var(--sp-4);">Importando...</h4><p>Estamos guardando tus datos. Por favor, no cierres esta ventana.</p></div><div id="json-import-result" style="display: none;"><span class="material-icons" style="font-size: 60px; color: var(--c-success);">task_alt</span><h4 id="json-result-title" style="margin-top: var(--sp-2);">¬°Importaci√≥n Completada!</h4><p id="json-result-message"></p><div class="modal__actions" style="justify-content: center;"><button class="btn btn--primary" data-action="close-modal" data-modal-id="json-import-wizard-modal">Finalizar</button></div></div></div></div></div>
    </div>

    <div id="exit-screen"><p>Finanzas al d√≠a ‚úÖ Movimientos revisados üëÄ  <br>üí∞ aiDANaI simplifica tus cuentas üí∞</p></div>
    
    <div id="help-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="help-modal-title">
        <div class="modal" style="max-width: 650px; max-height: 80vh;"><header class="modal__header"><h3 id="help-modal-title" class="modal__title"></h3><button class="icon-btn" data-action="close-modal" data-modal-id="help-modal" title="Cerrar" aria-label="Cerrar"><span class="material-icons">close</span></button></header><div id="help-modal-body" class="modal__body"></div></div>
    </div>
 
    <div id="calculator-overlay" class="modal-overlay" style="background: transparent;">
    <div id="calculator-ui" class="calculator-ui">
        <div id="calculator-history-display" class="calculator-history-display"></div>
        <div id="calculator-display" class="calculator-display">0</div>
        
        <div id="calculator-grid" class="calculator-grid">
            <button class="calculator-btn" data-key="clear" style="color: var(--c-danger); font-weight:700;">AC</button>
            <button class="calculator-btn" data-key="divide" style="font-size: 1.4rem;">√∑</button>
            <button class="calculator-btn" data-key="multiply" style="font-size: 1.4rem;">√ó</button>
            <button class="calculator-btn" data-key="backspace"><span class="material-icons backspace-icon">backspace</span></button>

            <button class="calculator-btn" data-key="7">7</button>
            <button class="calculator-btn" data-key="8">8</button>
            <button class="calculator-btn" data-key="9">9</button>
            <button class="calculator-btn" data-key="subtract" style="font-size: 1.8rem;">‚àí</button>

            <button class="calculator-btn" data-key="4">4</button>
            <button class="calculator-btn" data-key="5">5</button>
            <button class="calculator-btn" data-key="6">6</button>
            <button class="calculator-btn" data-key="add" style="font-size: 1.6rem;">+</button>

            <button class="calculator-btn" data-key="1">1</button>
            <button class="calculator-btn" data-key="2">2</button>
            <button class="calculator-btn" data-key="3">3</button>
            <button class="btn btn--primary calculator-btn btn-confirm" id="calculator-btn-done" data-key="done" style="grid-row: span 2; background-color: var(--c-primary);">OK</button>

            <button class="calculator-btn zero" data-key="0">0</button>
            <button class="calculator-btn" data-key="comma">,</button>
        </div>
    </div>
</div>
	
	<div id="irr-history-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="irr-history-title">
        <div class="modal"><div class="modal__grabber"></div><header class="modal__header"><h3 id="irr-history-title" class="modal__title">Evoluci√≥n de la TIR</h3><button class="icon-btn" data-action="close-modal" data-modal-id="irr-history-modal" title="Cerrar" aria-label="Cerrar"><span class="material-icons">close</span></button></header><div id="irr-history-body" class="modal__body"><div class="chart-container" style="height: 100%;"><canvas id="irr-history-chart"></canvas></div></div></div>
	</div> 
	<!-- ‚ñº‚ñº‚ñº INICIO: MEJORA 1 - Bottom Sheet para Acciones R√°pidas ‚ñº‚ñº‚ñº -->
    <div id="main-add-sheet" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="main-add-sheet-title">
        <div class="modal">
            <div class="modal__grabber"></div>
            <header class="modal__header" style="padding-top: var(--sp-2);">
                <h3 id="main-add-sheet-title" class="modal__title">¬øQu√© quieres a√±adir?</h3>
                <button class="icon-btn" data-action="close-modal" data-modal-id="main-add-sheet" title="Cerrar" aria-label="Cerrar"><span class="material-icons">close</span></button>
            </header>
            <div class="modal__body" id="main-add-sheet-body">
                <button class="add-sheet-button" data-action="open-movement-form" data-type="gasto">
                    <span class="material-icons" style="color: var(--c-danger);">trending_down</span>
                    <span>A√±adir Gasto</span>
                </button>
                <button class="add-sheet-button" data-action="open-movement-form" data-type="ingreso">
                    <span class="material-icons" style="color: var(--c-success);">trending_up</span>
                    <span>A√±adir Ingreso</span>
                </button>
                <button class="add-sheet-button" data-action="open-movement-form" data-type="traspaso">
                    <span class="material-icons" style="color: var(--c-info);">swap_horiz</span>
                    <span>Hacer un Traspaso</span>
                </button>
            </div>
        </div>
    </div>
	<!-- ‚ñ≤‚ñ≤‚ñ≤ FIN: MEJORA 1 - Bottom Sheet para Acciones R√°pidas ‚ñ≤‚ñ≤‚ñ≤ -->
	<!-- ‚ñº‚ñº‚ñº INICIO: NUEVO MEN√ö DESPLEGABLE PRINCIPAL ‚ñº‚ñº‚ñº -->
    <div id="main-menu-popover" class="popover-menu">
    
    <button class="popover-menu__item" data-action="global-search">
        <span class="material-icons">search</span>
        <span>Buscar</span>
    </button>

    <button class="popover-menu__item" data-action="toggle-theme">
        <span class="material-icons">brightness_6</span>
        <span>Cambiar Tema</span>
    </button>

    <div class="popover-menu__divider"></div>

    <button class="popover-menu__item" data-action="navigate" data-page="ajustes-page">
        <span class="material-icons">settings</span>
        <span>Ajustes</span>
    </button>
    <button class="popover-menu__item" data-action="help">
        <span class="material-icons">help_outline</span>
        <span>Gu√≠a de Usuario</span>
    </button>
    
    <div class="popover-menu__divider"></div>
    
    <button class="popover-menu__item popover-menu__item--danger" data-action="logout">
        <span class="material-icons">logout</span>
        <span>Cerrar Sesi√≥n</span>
    </button>
</div>
    <!-- ‚ñ≤‚ñ≤‚ñ≤ FIN: NUEVO MEN√ö DESPLEGABLE PRINCIPAL ‚ñ≤‚ñ≤‚ñ≤ -->
	<div id="calculator-iframe-modal" class="modal-overlay" role="dialog" aria-modal="true" style="z-index: 11000;">
        <div class="modal" style="padding: 0; height: 95dvh; max-height: 95dvh; background-color: #000; display: flex; flex-direction: column; overflow: hidden;">
            <button class="icon-btn" data-action="close-modal" data-modal-id="calculator-iframe-modal" style="position: absolute; top: 15px; right: 15px; z-index: 100; background: rgba(50,50,50,0.8); color: white; border: 1px solid rgba(255,255,255,0.2); width: 36px; height: 36px;">
                <span class="material-icons">close</span>
            </button>
            
            <iframe id="calculator-frame" style="width: 100%; height: 100%; border: none; flex-grow: 1;" loading="lazy"></iframe>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
	
    <script type="module" src="main.js"></script>
</body>
</html>
